<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>CacheViz - Interactive Cache Visualizer</title>
  <link rel="stylesheet" href="styles.css">
</head>

<body>
  <!-- Mobile Block Overlay -->
  <div id="mobile-block" class="mobile-block">
    <div class="mobile-block-content">
      <div class="mobile-block-icon">üñ•Ô∏è</div>
      <h2>Desktop Required</h2>
      <p>CacheViz requires a larger screen to display the cache visualization properly.</p>
      <p class="mobile-block-hint">Please open this page on a desktop or laptop computer.</p>
    </div>
  </div>


  <div class="container" role="main" id="main-content">
    <!-- Left Panel: Control & Info -->
    <div class="panel left-panel" role="complementary" aria-label="Cache control panel">
      <h1 class="title">CacheViz</h1>

      <div class="stats-section" role="region" aria-labelledby="stats-heading" aria-live="polite" aria-atomic="false">
        <h2 id="stats-heading">Statistics</h2>
        <div class="stat-item">
          <span class="stat-label">‚ú® Cache Hits:</span>
          <span class="stat-value hit-count" aria-label="Cache hits count">0</span>
        </div>
        <div class="stat-item">
          <span class="stat-label">üí® Cache Misses:</span>
          <span class="stat-value miss-count" aria-label="Cache misses count">0</span>
        </div>
        <div class="stat-item">
          <span class="stat-label">üìä Hit Rate:</span>
          <span class="stat-value hit-rate" aria-label="Cache hit rate percentage">0%</span>
        </div>
      </div>

      <div id="address-breakdown" class="address-breakdown" style="display: none">
        <div class="breakdown-title">Address Breakdown</div>
        <div class="breakdown-bits">
          <div class="bit-group bit-tag">
            <div class="bit-label">TAG</div>
            <div class="bit-value" id="tag-value">-</div>
          </div>
          <div class="bit-group bit-index-set">
            <div class="bit-label" id="index-set-label">INDEX</div>
            <div class="bit-value" id="index-set-value">-</div>
          </div>
          <div class="bit-group bit-offset">
            <div class="bit-label">OFFSET</div>
            <div class="bit-value" id="offset-value">-</div>
          </div>
        </div>
      </div>

      <div class="mode-section" role="region" aria-labelledby="mode-heading">
        <h2 id="mode-heading">Cache Mapping Mode</h2>
        <div class="mode-options" role="radiogroup" aria-labelledby="mode-heading">
          <label class="mode-option">
            <input type="radio" name="cache-mode" value="direct" class="mode-radio" aria-describedby="direct-desc">
            <div class="mode-info">
              <span class="mode-label">Direct Mapped</span>
              <span class="mode-sublabel" id="direct-desc">Each address maps to one cache line</span>
            </div>
          </label>
          <label class="mode-option">
            <input type="radio" name="cache-mode" value="set-associative" class="mode-radio"
              aria-describedby="set-desc">
            <div class="mode-info">
              <span class="mode-label">N-Way Set-Associative</span>
              <span class="mode-sublabel" id="set-desc">(2-Way)</span>
            </div>
          </label>
          <label class="mode-option">
            <input type="radio" name="cache-mode" value="fully-associative" class="mode-radio" checked
              aria-describedby="fully-desc">
            <div class="mode-info">
              <span class="mode-label">Fully Associative</span>
              <span class="mode-sublabel" id="fully-desc">Any address can map to any cache line</span>
            </div>
          </label>
        </div>
      </div>

      <div class="input-section">
        <h2>Execute Command</h2>
        <textarea id="command-input" placeholder="e.g., LOAD R1, 0x1A4&#10;LOAD R2, 0x1A4" class="command-input"
          rows="5" aria-label="Command input for cache operations"></textarea>
        <button id="execute-btn" class="execute-btn" aria-label="Execute the entered cache commands">
          Execute
        </button>
      </div>

      <div class="examples-section" role="region" aria-labelledby="examples-heading">
        <h2 id="examples-heading">Examples</h2>
        <ul class="examples-list" role="list">
          <li class="example-item" data-command="LOAD R1, 0x1A4" tabindex="0" role="button"
            aria-label="Load example: The First Miss">
            The First Miss
          </li>
          <li class="example-item" data-command="LOAD R1, 0x1A4&#10;LOAD R3, 0x2B0&#10;STORE R2, 0x1A4" tabindex="0"
            role="button" aria-label="Load example: Miss, then Hit">
            Miss, then Hit
          </li>
          <li class="example-item"
            data-command="LOAD R1, 0x1A4&#10;STORE R2, 0x2B0&#10;LOAD R3, 0x3C8&#10;STORE R4, 0x4D0&#10;LOAD R5, 0x1A4"
            tabindex="0" role="button" aria-label="Load example: Forcing a Replacement">
            Forcing a Replacement
          </li>
        </ul>
      </div>

      <div class="reset-section">
        <button id="reset-btn" class="reset-btn" aria-label="Reset simulation to initial state">
          Reset Simulation
        </button>
      </div>
    </div>

    <!-- Center Panel: Visualization (Canvas) -->
    <div class="panel center-panel">
      <canvas id="visualization" aria-label="Cache visualization diagram showing CPU, Cache, and Main Memory"></canvas>
    </div>

    <!-- Right Panel: Event Log -->
    <div class="panel right-panel" id="right-panel" role="complementary" aria-label="Event log panel">
      <div class="panel-header">
        <h2 id="event-log-heading">Event Log</h2>
        <button id="toggle-log" class="toggle-btn" aria-label="Toggle event log visibility">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"
            stroke-linecap="round" stroke-linejoin="round">
            <polyline points="13 17 18 12 13 7"></polyline>
            <polyline points="6 17 11 12 6 7"></polyline>
          </svg>
        </button>
      </div>
      <div id="event-log-container" class="log-container">
        <div id="event-log" class="event-log" role="log" aria-live="polite" aria-atomic="false"
          aria-labelledby="event-log-heading">
        </div>
      </div>
    </div>
  </div>

  <!-- Confirmation Modal -->
  <div id="reset-modal" class="modal" style="display: none" role="dialog" aria-modal="true"
    aria-labelledby="modal-title" aria-describedby="modal-message">
    <div class="modal-overlay" aria-hidden="true"></div>
    <div class="modal-content">
      <h3 id="modal-title" class="modal-title">Reset Simulation?</h3>
      <p id="modal-message" class="modal-message">
        This will clear all cache data, statistics, and event logs. This
        action cannot be undone.
      </p>
      <div class="modal-actions">
        <button id="modal-cancel" class="modal-btn modal-cancel" aria-label="Cancel reset">
          Cancel
        </button>
        <button id="modal-confirm" class="modal-btn modal-confirm" aria-label="Confirm reset simulation">
          Reset
        </button>
      </div>
    </div>
  </div>

  <script src="app.js"></script>
</body>

</html>